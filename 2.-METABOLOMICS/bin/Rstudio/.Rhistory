metabolitos2$X2_alfa.Muurolene <- metabolitos2$x1*metabolitos$alfa.Muurolene/metabolitos$P.Area.estandar
metabolitos2$X3_alfa.Muurolene <- metabolitos2$X2_alfa.Muurolene*metabolitos$microlitros.de.metabolitos/metabolitos$microlitros.de.inyeccion
metabolitos2$X4_alfa.Muurolene <- metabolitos2$X3_alfa.Muurolene*100/metabolitos$Peso.acicula.gramos
metabolitos2$X5_alfa.Muurolene <- metabolitos2$X4_alfa.Muurolene*1000
metabolitos3<- data.frame(metabolitos2$C.A.T,metabolitos2$C.A,metabolitos2$Temporada,metabolitos2$Condicion,metabolitos2$A.expo, metabolitos2$Muestra, metabolitos2$mmet,
metabolitos2$X4_beta.pinene, metabolitos2$X4_L.alfa.bornyl.acetate , metabolitos2$X4_beta.Caryophyllene.oxide, metabolitos2$X4_alfa.Caryophyllene,
metabolitos2$X4_beta.Cubebene,metabolitos2$X4_alfa.Cubenene,metabolitos2$X4_delta.Cadinene,metabolitos2$X4_alfa.Muurolene)
View(metabolitos3)
colnames(metabolitos3)<- c("C-A-T","C-A","Temporada","Condicion", "A.exposicion", "Muestra","n.GC-MS",
"beta.pinene","L.alfa.bornyl.acetate","beta.Caryophyllene.oxide","alfa.Caryophyllene",
"beta.Cubebene","alfa.Cubenene","delta.Cadinene","alfa.Muurolene")
View(metabolitos3)
write.table(metabolitos3, "../../metadata/calculate_relative_abs.txt", sep="\t", row.names=FALSE)
read.delim("../../metadata/calculate_relative_abs.txt", sep="\t", row.names=FALSE)
read.delim("../../metadata/calculate_relative_abs.txt", row.names=FALSE)
read.delim("../../metadata/calculate_relative_abs.txt")
metabolites<-read.delim("../../metadata/calculate_relative_abs.txt")
View(metabolites)
beta.pinene<- metabolites[,c(3:5,8)]
L.alfa.bornyl.acetate<- metabolites[,c(3:5,9)]
beta.Caryophyllene.oxide<- metabolites[,c(3:5,10)]
alfa.Caryophyllene<- metabolites[,c(3:5,11)]
beta.Cubebene<- metabolites[,c(3:5,12)]
alfa.Cubenene<- metabolites[,c(3:5,13)]
delta.Cadinene<- metabolites[,c(3:5,14)]
alfa.Muurolene<- metabolites[,c(3:5,15)]
plot.design(beta.pinene ~ ., data = beta.pinene)
plot.design(alfa.Caryophyllene ~ ., data = alfa.Caryophyllene)
plot.design(delta.Cadinene ~ ., data =delta.Cadinene)
with(beta.pinene, {
interaction.plot(Temporada, Condicion, beta.pinene)
interaction.plot(Temporada, A.exposicion, beta.pinene)
interaction.plot(A.exposicion, Condicion, beta.pinene)
}
)
par(op)
par(op)
op <- par(mfrow = c(4, 1))
par(op)
with(beta.pinene, {
interaction.plot(Temporada, Condicion, beta.pinene)
interaction.plot(Temporada, A.exposicion, beta.pinene)
interaction.plot(A.exposicion, Condicion, beta.pinene)
}
)
par(op)
op <- par(mfrow = c(4, 1))
with(beta.pinene, {
interaction.plot(Temporada, Condicion, beta.pinene)
interaction.plot(Temporada, A.exposicion, beta.pinene)
interaction.plot(A.exposicion, Condicion, beta.pinene)
}
)
par(op)
fm <- aov(beta.pinene ~ Temporada * Condicion * A.exposicion, data = beta.pinene)
fm
# fm <- aov(Bornil_Acetato ~ Temporada + Condicion + Tiempo_exposicion + Temporada:Condicion + Temporada:Tiempo_exposicion + Condicion:Tiempo_exposicion
#          + Temporada:Condicion:Tiempo_exposicion, data = Bornil_Acetato)
summary(fm)
# Datos completos
fmbeta.pinene <- aov(beta.pinene ~ Temporada * Condicion * A.exposicion, data = beta.pinene)
fmL.alfa.bornyl.acetate <- aov(L.alfa.bornyl.acetate ~ Temporada * Condicion * A.exposicion, data = L.alfa.bornyl.acetate)
fmbeta.Caryophyllene.oxide<- aov(beta.Caryophyllene.oxide ~ Temporada * Condicion * A.exposicion, data = beta.Caryophyllene.oxide)
fmalfa.Caryophyllene <- aov(alfa.Caryophyllene ~ Temporada * Condicion * A.exposicion, data = alfa.Caryophyllene)
fmbeta.Cubebene<- aov(beta.Cubebene ~ Temporada * Condicion * A.exposicion, data = beta.Cubebene)
fmalfa.Cubenene <- aov(alfa.Cubenene ~ Temporada * Condicion * A.exposicion, data = alfa.Cubenene)
fmdelta.Cadinene<- aov(delta.Cadinene ~ Temporada * Condicion * A.exposicion, data = delta.Cadinene)
fmalfa.Muurolene <- aov(alfa.Muurolene ~ Temporada * Condicion * A.exposicion, data = alfa.Muurolene)
summary(fmbeta.pinene)
summary(fmL.alfa.bornyl.acetate)
summary(fmbeta.Caryophyllene.oxide)
summary(fmalfa.Caryophyllene)
summary(fmbeta.Cubebene)
summary(fmalfa.Cubenene)
summary(fmdelta.Cadinene)
summary(fmalfa.Muurolene)
beta.pinene<-summary(fmbeta.pinene)
beta.pinene<- summary(fmbeta.pinene)
# Load file
metabolites<-read.delim("../../metadata/calculate_relative_abs.txt")
# ANOVA per metabolite
beta.pinene<- metabolites[,c(3:5,8)]
L.alfa.bornyl.acetate<- metabolites[,c(3:5,9)]
beta.Caryophyllene.oxide<- metabolites[,c(3:5,10)]
alfa.Caryophyllene<- metabolites[,c(3:5,11)]
beta.Cubebene<- metabolites[,c(3:5,12)]
alfa.Cubenene<- metabolites[,c(3:5,13)]
delta.Cadinene<- metabolites[,c(3:5,14)]
alfa.Muurolene<- metabolites[,c(3:5,15)]
# Efecto univariado 1 Factor
plot.design(beta.pinene ~ ., data = beta.pinene)
plot.design(alfa.Caryophyllene ~ ., data = alfa.Caryophyllene)
plot.design(delta.Cadinene ~ ., data =delta.Cadinene)
# Comparación de medias 2 Factores
op <- par(mfrow = c(4, 1))
with(beta.pinene, {
interaction.plot(Temporada, Condicion, beta.pinene)
interaction.plot(Temporada, A.exposicion, beta.pinene)
interaction.plot(A.exposicion, Condicion, beta.pinene)
}
)
par(op)
# Comparación de medias 3 Factores
fm <- aov(beta.pinene ~ Temporada * Condicion * A.exposicion, data = beta.pinene)
# Notice that this is equivalent to writing:
# fm <- aov(Bornil_Acetato ~ Temporada + Condicion + Tiempo_exposicion + Temporada:Condicion + Temporada:Tiempo_exposicion + Condicion:Tiempo_exposicion
#          + Temporada:Condicion:Tiempo_exposicion, data = Bornil_Acetato)
summary(fm)
# Datos completos
fmbeta.pinene <- aov(beta.pinene ~ Temporada * Condicion * A.exposicion, data = beta.pinene)
fmL.alfa.bornyl.acetate <- aov(L.alfa.bornyl.acetate ~ Temporada * Condicion * A.exposicion, data = L.alfa.bornyl.acetate)
fmbeta.Caryophyllene.oxide<- aov(beta.Caryophyllene.oxide ~ Temporada * Condicion * A.exposicion, data = beta.Caryophyllene.oxide)
fmalfa.Caryophyllene <- aov(alfa.Caryophyllene ~ Temporada * Condicion * A.exposicion, data = alfa.Caryophyllene)
fmbeta.Cubebene<- aov(beta.Cubebene ~ Temporada * Condicion * A.exposicion, data = beta.Cubebene)
fmalfa.Cubenene <- aov(alfa.Cubenene ~ Temporada * Condicion * A.exposicion, data = alfa.Cubenene)
fmdelta.Cadinene<- aov(delta.Cadinene ~ Temporada * Condicion * A.exposicion, data = delta.Cadinene)
fmalfa.Muurolene <- aov(alfa.Muurolene ~ Temporada * Condicion * A.exposicion, data = alfa.Muurolene)
beta.pinene<- summary(fmbeta.pinene)
beta.pinene
write.table(beta.pinene, "../../metadata/beta.pinene.txt", sep="\t", row.names=FALSE)
writeLines(beta.pinene, "../../metadata/beta.pinene.txt", sep="\t", row.names=FALSE)
writeLines(beta.pinene)
metabolites<-read.delim("../../metadata/calculate_relative_abs.txt")
# Plotear
library(ggplot2)
library(reshape2)
metabolites<-read.delim("../../metadata/calculate_relative_abs.txt")
# Plotear
library(ggplot2)
library(reshape2)
metabolites_mean <- aggregate(metabolites3[,8:15], by=list(Factores=metabolites3$`C-A-T`), FUN=mean)
metabolites_mean <- aggregate(metabolites[,8:15], by=list(Factores=metabolites3$`C-A-T`), FUN=mean)
# Plotear
library(ggplot2)
library(reshape2)
metabolites_mean <- aggregate(metabolites[,8:15], by=list(Factores=metabolites$`C-A-T`), FUN=mean)
metabolites<-read.delim("../../metadata/calculate_relative_abs.txt")
# Plotear
library(ggplot2)
library(reshape2)
metabolites_mean <- aggregate(metabolites[,8:15], by=list(Factores=metabolites$`C-A-T`), FUN=mean)
View(metabolites)
metabolites_mean <- aggregate(metabolites[,8:15], by=list(Factores=metabolites$C.A.T), FUN=mean)
View(metabolites)
metabolites_sd <- aggregate(metabolites3[,8:15], by=list(Factores=metabolites3$C-A-T), FUN=sd)
metabolites_sd <- aggregate(metabolites[,8:15], by=list(Factores=metabolites$C-A-T), FUN=sd)
metabolites_sd <- aggregate(metabolites[,8:15], by=list(Factores=metabolites$C.A.T), FUN=sd)
df_mean <- melt(metabolites_mean, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
df_sd <- melt(metabolites_sd, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
#SS
levels(df_mean$Factores)
levels(df_mean$Factores)<- c("Contingencia Dañada 2015","Concentración moderada Dañada 2015",
"Contingencia Dañada 2016","Concentración moderada Dañada 2016",
"Contingencia Sana 2015","Concentración moderada Sana 2015",
"Contingencia Sana 2016","Concentración moderada Sana 2016")
metabolites4<-data.frame(metabolites3)[1:20,]
metabolites4<-data.frame(metabolites)[1:20,]
metabolites_mean <- aggregate(metabolites4[,8:15], by=list(Factores=metabolites4$C.A.T), FUN=mean)
metabolites_sd <- aggregate(metabolites4[,8:15], by=list(Factores=metabolites4$C.A.T), FUN=sd)
df_mean <- melt(metabolites_mean, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
df_sd <- melt(metabolites_sd, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
limits <- aes(ymax = df_mean[,"value"] + df_sd[,"value"], ymin=df_mean[,"value"] - df_sd[,"value"])
p <- ggplot(df_mean, aes(metabolito, value, fill = Factores)) +
geom_bar(position="dodge", stat="identity") + geom_errorbar(limits, position="dodge")
print(p)
p + coord_flip() + facet_wrap(~ Factores) +
scale_fill_manual(breaks = c("Concentración moderada Dañada 2015", "Concentración moderada Dañada 2016",
"Concentración moderada Sana 2015", "Concentración moderada Sana 2016"),
values= c( "#c6003a", "#e98382", "#00901e","#b1e787"))+
scale_x_discrete (labels = c('beta.pinene' = expression(beta~'-Pineno'),
'L.alfa.bornyl.acetate' = expression('L-'~ alpha ~'-Acetato de Bornilo'),
'beta.Caryophyllene.oxide'= expression(beta~'-Óxido de Cariofileno'),
'alfa.Caryophyllene' = expression(alpha~'-Cariofileno'),
'beta.Cubebene'= expression(beta~'-Cubebeno'),
'alfa.Cubenene'= expression(alpha~'-Cubeneno'),
'delta.Cadinene' = expression(delta~'-Cadineno'),
'alfa.Muurolene' = expression(alpha~'-Muuroleno')))
metabolites4<-data.frame(metabolites3)[21:40,]
metabolites4<-data.frame(metabolites)[21:40,]
metabolites_mean <- aggregate(metabolites4[,8:15], by=list(Factores=metabolites4$C.A.T), FUN=mean)
metabolites_sd <- aggregate(metabolites4[,8:15], by=list(Factores=metabolites4$C.A.T), FUN=sd)
df_mean <- melt(metabolites_mean, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
df_sd <- melt(metabolites_sd, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
limits <- aes(ymax = df_mean[,"value"] + df_sd[,"value"], ymin=df_mean[,"value"] - df_sd[,"value"])
p <- ggplot(df_mean, aes(metabolito, value, fill = Factores)) +
geom_bar(position="dodge", stat="identity") + geom_errorbar(limits, position="dodge")
print(p)
p + coord_flip() + facet_wrap(~ Factores) +
scale_fill_manual(breaks = c("Concentración moderada Dañada 2015", "Concentración moderada Dañada 2016",
"Concentración moderada Sana 2015", "Concentración moderada Sana 2016"),
values= c( "#c6003a", "#e98382", "#00901e","#b1e787"))+
scale_x_discrete (labels = c('beta.pinene' = expression(beta~'-Pineno'),
'L.alfa.bornyl.acetate' = expression('L-'~ alpha ~'-Acetato de Bornilo'),
'beta.Caryophyllene.oxide'= expression(beta~'-Óxido de Cariofileno'),
'alfa.Caryophyllene' = expression(alpha~'-Cariofileno'),
'beta.Cubebene'= expression(beta~'-Cubebeno'),
'alfa.Cubenene'= expression(alpha~'-Cubeneno'),
'delta.Cadinene' = expression(delta~'-Cadineno'),
'alfa.Muurolene' = expression(alpha~'-Muuroleno')))
limits <- aes(ymax = df_mean[,"value"] + df_sd[,"value"], ymin=df_mean[,"value"] - df_sd[,"value"])
p + coord_flip() + facet_wrap(~ Factores) +
scale_fill_manual(breaks = c("Concentración moderada Dañada 2015", "Concentración moderada Dañada 2016",
"Concentración moderada Sana 2015", "Concentración moderada Sana 2016"),
values= c( "#c6003a", "#e98382", "#00901e","#b1e787"))+
scale_x_discrete (labels = c('beta.pinene' = expression(beta~'-Pineno'),
'L.alfa.bornyl.acetate' = expression('L-'~ alpha ~'-Acetato de Bornilo'),
'beta.Caryophyllene.oxide'= expression(beta~'-Óxido de Cariofileno'),
'alfa.Caryophyllene' = expression(alpha~'-Cariofileno'),
'beta.Cubebene'= expression(beta~'-Cubebeno'),
'alfa.Cubenene'= expression(alpha~'-Cubeneno'),
'delta.Cadinene' = expression(delta~'-Cadineno'),
'alfa.Muurolene' = expression(alpha~'-Muuroleno')))
png("barplot_images_conti.png")
p + coord_flip() + facet_wrap(~ Factores) +
scale_fill_manual(breaks = c("Concentración moderada Dañada 2015", "Concentración moderada Dañada 2016",
"Concentración moderada Sana 2015", "Concentración moderada Sana 2016"),
values= c( "#c6003a", "#e98382", "#00901e","#b1e787"))+
scale_x_discrete (labels = c('beta.pinene' = expression(beta~'-Pineno'),
'L.alfa.bornyl.acetate' = expression('L-'~ alpha ~'-Acetato de Bornilo'),
'beta.Caryophyllene.oxide'= expression(beta~'-Óxido de Cariofileno'),
'alfa.Caryophyllene' = expression(alpha~'-Cariofileno'),
'beta.Cubebene'= expression(beta~'-Cubebeno'),
'alfa.Cubenene'= expression(alpha~'-Cubeneno'),
'delta.Cadinene' = expression(delta~'-Cadineno'),
'alfa.Muurolene' = expression(alpha~'-Muuroleno')))
dev.off()
p<-p + coord_flip() + facet_wrap(~ Factores) +
scale_fill_manual(breaks = c("Concentración moderada Dañada 2015", "Concentración moderada Dañada 2016",
"Concentración moderada Sana 2015", "Concentración moderada Sana 2016"),
values= c( "#c6003a", "#e98382", "#00901e","#b1e787"))+
scale_x_discrete (labels = c('beta.pinene' = expression(beta~'-Pineno'),
'L.alfa.bornyl.acetate' = expression('L-'~ alpha ~'-Acetato de Bornilo'),
'beta.Caryophyllene.oxide'= expression(beta~'-Óxido de Cariofileno'),
'alfa.Caryophyllene' = expression(alpha~'-Cariofileno'),
'beta.Cubebene'= expression(beta~'-Cubebeno'),
'alfa.Cubenene'= expression(alpha~'-Cubeneno'),
'delta.Cadinene' = expression(delta~'-Cadineno'),
'alfa.Muurolene' = expression(alpha~'-Muuroleno')))
Cairo(file="barplot_images_conti.png",
type="png",
units="in",
width=5*2,
height=4*2,
pointsize=12*2,
dpi=72)
install.packages("Cairo")
library(Cairo)
library(Cairo)
Cairo(file="barplot_images_conti.png",
type="png",
units="in",
width=5*2,
height=4*2,
pointsize=12*2,
dpi=72)
my_sc_plot(p)
Cairo(file="Cairo_PNG_96_dpi_adj.png",
type="png",
units="in",
width=5,
height=4,
pointsize=12*92/72,
dpi=96)
detach("package:Cairo", unload = TRUE)
library(Cairo)
p + coord_flip() + facet_wrap(~ Factores) +
scale_fill_manual(breaks = c("Concentración moderada Dañada 2015", "Concentración moderada Dañada 2016",
"Concentración moderada Sana 2015", "Concentración moderada Sana 2016"),
values= c( "#c6003a", "#e98382", "#00901e","#b1e787"))+
scale_x_discrete (labels = c('beta.pinene' = expression(beta~'-Pineno'),
'L.alfa.bornyl.acetate' = expression('L-'~ alpha ~'-Acetato de Bornilo'),
'beta.Caryophyllene.oxide'= expression(beta~'-Óxido de Cariofileno'),
'alfa.Caryophyllene' = expression(alpha~'-Cariofileno'),
'beta.Cubebene'= expression(beta~'-Cubebeno'),
'alfa.Cubenene'= expression(alpha~'-Cubeneno'),
'delta.Cadinene' = expression(delta~'-Cadineno'),
'alfa.Muurolene' = expression(alpha~'-Muuroleno')))
metabolites<-read.delim("../../metadata/calculate_relative_abs.txt")
# Plotear
library(ggplot2)
library(reshape2)
metabolites_mean <- aggregate(metabolites[,8:15], by=list(Factores=metabolites$C.A.T), FUN=mean)
metabolites_sd <- aggregate(metabolites[,8:15], by=list(Factores=metabolites$C.A.T), FUN=sd)
df_mean <- melt(metabolites_mean, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
df_sd <- melt(metabolites_sd, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
#SS
levels(df_mean$Factores)
levels(df_mean$Factores)<- c("Contingencia Dañada 2015","Concentración moderada Dañada 2015",
"Contingencia Dañada 2016","Concentración moderada Dañada 2016",
"Contingencia Sana 2015","Concentración moderada Sana 2015",
"Contingencia Sana 2016","Concentración moderada Sana 2016")
metabolites4<-data.frame(metabolites)[1:20,]
metabolites_mean <- aggregate(metabolites4[,8:15], by=list(Factores=metabolites4$C.A.T), FUN=mean)
metabolites_sd <- aggregate(metabolites4[,8:15], by=list(Factores=metabolites4$C.A.T), FUN=sd)
df_mean <- melt(metabolites_mean, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
df_sd <- melt(metabolites_sd, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
limits <- aes(ymax = df_mean[,"value"] + df_sd[,"value"], ymin=df_mean[,"value"] - df_sd[,"value"])
p <- ggplot(df_mean, aes(metabolito, value, fill = Factores)) +
geom_bar(position="dodge", stat="identity") + geom_errorbar(limits, position="dodge")
print(p)
p + coord_flip() + facet_wrap(~ Factores) +
scale_fill_manual(breaks = c("Concentración moderada Dañada 2015", "Concentración moderada Dañada 2016",
"Concentración moderada Sana 2015", "Concentración moderada Sana 2016"),
values= c( "#c6003a", "#e98382", "#00901e","#b1e787"))+
scale_x_discrete (labels = c('beta.pinene' = expression(beta~'-Pineno'),
'L.alfa.bornyl.acetate' = expression('L-'~ alpha ~'-Acetato de Bornilo'),
'beta.Caryophyllene.oxide'= expression(beta~'-Óxido de Cariofileno'),
'alfa.Caryophyllene' = expression(alpha~'-Cariofileno'),
'beta.Cubebene'= expression(beta~'-Cubebeno'),
'alfa.Cubenene'= expression(alpha~'-Cubeneno'),
'delta.Cadinene' = expression(delta~'-Cadineno'),
'alfa.Muurolene' = expression(alpha~'-Muuroleno')))
metabolites4<-data.frame(metabolites)[21:40,]
metabolites_mean <- aggregate(metabolites4[,8:15], by=list(Factores=metabolites4$C.A.T), FUN=mean)
metabolites_sd <- aggregate(metabolites4[,8:15], by=list(Factores=metabolites4$C.A.T), FUN=sd)
df_mean <- melt(metabolites_mean, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
df_sd <- melt(metabolites_sd, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
limits <- aes(ymax = df_mean[,"value"] + df_sd[,"value"], ymin=df_mean[,"value"] - df_sd[,"value"])
p <- ggplot(df_mean, aes(metabolito, value, fill = Factores)) +
geom_bar(position="dodge", stat="identity") + geom_errorbar(limits, position="dodge")
print(p)
p + coord_flip() + facet_wrap(~ Factores) +
scale_fill_manual(breaks = c("Concentración moderada Dañada 2015", "Concentración moderada Dañada 2016",
"Concentración moderada Sana 2015", "Concentración moderada Sana 2016"),
values= c( "#c6003a", "#e98382", "#00901e","#b1e787"))+
scale_x_discrete (labels = c('beta.pinene' = expression(beta~'-Pineno'),
'L.alfa.bornyl.acetate' = expression('L-'~ alpha ~'-Acetato de Bornilo'),
'beta.Caryophyllene.oxide'= expression(beta~'-Óxido de Cariofileno'),
'alfa.Caryophyllene' = expression(alpha~'-Cariofileno'),
'beta.Cubebene'= expression(beta~'-Cubebeno'),
'alfa.Cubenene'= expression(alpha~'-Cubeneno'),
'delta.Cadinene' = expression(delta~'-Cadineno'),
'alfa.Muurolene' = expression(alpha~'-Muuroleno')))
ggsave("barplot_images_conti.png")
ggsave("barplot_images_conti.png", width = 480, height = 480, units = "px")
ggsave("barplot_images_conti.png", width = 480, height = 480, units = "cm")
ggsave("barplot_images_conti.png")
ggsave("../../outputs/barplot_images_conti.png")
install.packages(c("corrplot", "ggfortify"))
# Plotear
library(ggplot2)
library(reshape2)
#Load file
metabolites<-read.delim("../../metadata/calculate_relative_abs.txt")
metabolites_mean <- aggregate(metabolitos3[,8:15], by=list(Factores=metabolitos3$`C-A-T`), FUN=mean)
metabolites_sd <- aggregate(metabolitos3[,8:15], by=list(Factores=metabolitos3$`C-A-T`), FUN=sd)
#Load file
metabolites<-read.delim("../../metadata/calculate_relative_abs.txt")
metabolites_mean <- aggregate(metabolites[,8:15], by=list(Factores=metabolites$C.A.T), FUN=mean)
metabolites_mean <- aggregate(metabolites[,8:15], by=list(Factores=metabolites$C.A.T), FUN=mean)
metabolites_sd <- aggregate(metabolites[,8:15], by=list(Factores=metabolites$C.A.T), FUN=sd)
df_mean <- melt(metabolites_mean, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
df_sd <- melt(metabolites_sd, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
limits <- aes(ymax = df_mean[,"value"] + df_sd[,"value"], ymin=df_mean[,"value"] - df_sd[,"value"])
p <- ggplot(df_mean, aes(metabolito, value, fill = Factores)) +
geom_bar(position="dodge", stat="identity") + geom_errorbar(limits, position="dodge")
print(p)
p <- ggplot(df_mean, aes(metabolito, value)) + geom_bar(aes(fill = Factores), stat="identity") +
facet_wrap(~Factores, ncol=1) + geom_errorbar(limits, position="dodge")
print(p)
p + coord_flip() + facet_wrap(~ Factores)
#SS
levels(df_mean$Factores)
levels(df_mean$Factores)<- c("Contingencia Dañada 2015","Concentración moderada Dañada 2015",
"Contingencia Dañada 2016","Concentración moderada Dañada 2016",
"Contingencia Sana 2015","Concentración moderada Sana 2015",
"Contingencia Sana 2016","Concentración moderada Sana 2016")
metabolitos4<-data.frame(metabolitos3)[1:20,]
metabolites_mean <- aggregate(metabolitos4[,8:15], by=list(Factores=metabolitos4$C.A.T), FUN=mean)
p
metabolitos4<-data.frame(metabolites)[1:20,]
metabolites_mean <- aggregate(metabolitos4[,8:15], by=list(Factores=metabolitos4$C.A.T), FUN=mean)
metabolites_sd <- aggregate(metabolitos4[,8:15], by=list(Factores=metabolitos4$C.A.T), FUN=sd)
df_mean <- melt(metabolites_mean, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
df_sd <- melt(metabolites_sd, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
limits <- aes(ymax = df_mean[,"value"] + df_sd[,"value"], ymin=df_mean[,"value"] - df_sd[,"value"])
p <- ggplot(df_mean, aes(metabolito, value, fill = Factores)) +
geom_bar(position="dodge", stat="identity") + geom_errorbar(limits, position="dodge")
print(p)
p <- ggplot(df_mean, aes(metabolito, value)) + geom_bar(aes(fill = Factores), stat="identity") +
facet_wrap(~Factores, ncol=1) + geom_errorbar(limits, position="dodge")
print(p)
p + coord_flip() + facet_wrap(~ Factores) +
scale_fill_manual(breaks = c("Concentración moderada Dañada 2015", "Concentración moderada Dañada 2016",
"Concentración moderada Sana 2015", "Concentración moderada Sana 2016"),
values= c( "#c6003a", "#e98382", "#00901e","#b1e787"))
metabolitos4<-data.frame(metabolitos3)[21:40,]
metabolites_mean <- aggregate(metabolitos4[,8:15], by=list(Factores=metabolitos4$C.A.T), FUN=mean)
metabolitos4<-data.frame(metabolites)[21:40,]
metabolites_mean <- aggregate(metabolitos4[,8:15], by=list(Factores=metabolitos4$C.A.T), FUN=mean)
metabolites_sd <- aggregate(metabolitos4[,8:15], by=list(Factores=metabolitos4$C.A.T), FUN=sd)
df_mean <- melt(metabolites_mean, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
df_sd <- melt(metabolites_sd, id.vars=c("Factores"), variable.name = "metabolito", value.name="value")
limits <- aes(ymax = df_mean[,"value"] + df_sd[,"value"], ymin=df_mean[,"value"] - df_sd[,"value"])
p <- ggplot(df_mean, aes(metabolito, value, fill = Factores)) +
geom_bar(position="dodge", stat="identity") + geom_errorbar(limits, position="dodge")
print(p)
p <- ggplot(df_mean, aes(metabolito, value)) + geom_bar(aes(fill = Factores), stat="identity") +
facet_wrap(~Factores, ncol=1) + geom_errorbar(limits, position="dodge")
print(p)
p + coord_flip() + facet_wrap(~ Factores)+
scale_fill_manual(breaks = c("Concentración moderada Dañada 2015", "Concentración moderada Dañada 2016",
"Concentración moderada Sana 2015", "Concentración moderada Sana 2016"),
values= c( "#c6003a", "#e98382", "#00901e","#b1e787"))
metabolites<-read.delim("../../metadata/calculate_relative_abs.txt")
metabolites<-read.delim("../../metadata/calculate_relative_abs.txt")
View(metabolites)
metabolitos3$PCA<-c(rep("SS15",5), rep("SS16",5),
rep("SD15",5),rep("SD16",5),
rep("CS15",5),rep("CS16",5),
rep("CD15",5),rep("CD16",5))
metabolites$PCA<-c(rep("SS15",5), rep("SS16",5),
rep("SD15",5),rep("SD16",5),
rep("CS15",5),rep("CS16",5),
rep("CD15",5),rep("CD16",5))
View(metabolites)
#Exportar Data frame
exp_table<-metabolites[,c(1,8:15)]
#Exportar Data frame
exp_table<-metabolites[,c(1,8:15)]
write.csv(exp_table, file="../../metadata/exp_table.csv")
write.table(exp_table, file="../../metadata/exp_table.txt")
metabolitosSS<-metabolites[1:20,]
metabolitosConti<-metabolites[21:40,]
metabolitosSS<-metabolites[1:20,]
metabolitosConti<-metabolites[21:40,]
df <- metabolites[c(8:15)]
autoplot(prcomp(df))
autoplot(prcomp(df), data = metabolitos3, colour = 'PCA', label = TRUE, label.size = 10)
library(ggfortify)
library(corrplot)
df <- metabolites[c(8:15)]
autoplot(prcomp(df))
autoplot(prcomp(df), data = metabolitos3, colour = 'PCA', label = TRUE, label.size = 10)
df <- metabolites[c(8:15)]
autoplot(prcomp(df))
autoplot(prcomp(df), data = metabolites, colour = 'PCA', label = TRUE, label.size = 10)
autoplot(prcomp(df), data = metabolites, colour = 'PCA', shape = FALSE, label.size = 3)
autoplot(prcomp(df), data = metabolites, colour = 'PCA', loadings = TRUE)
autoplot(prcomp(df), data = metabolites, colour = 'PCA',
loadings = TRUE, loadings.colour = 'purple',
loadings.label = TRUE, loadings.label.size = 3)
df2<- as.matrix(df)
M <- cor(df2)
corrplot(M, method = "circle")
corrplot(M, method = "number") # Display the correlation coefficient
p.mat <- cor.mtest(df2)$p
head(p.mat[, 1:8])
col <- colorRampPalette(c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
corrplot(M, method = "color", col = col(200),
type = "upper", order = "hclust", number.cex = .7,
addCoef.col = "black", # Add coefficient of correlation
tl.col = "black", tl.srt = 90, # Text label color and rotation
# Combine with significance
p.mat = p.mat, sig.level = 0.01, insig = "blank",
# hide correlation coefficient on the principal diagonal
diag = FALSE)
df3<-scale(df2)
autoplot(prcomp(df3), data = metabolitos3, colour = 'PCA',
loadings = TRUE, loadings.colour = 'purple',
loadings.label = TRUE, loadings.label.size = 3)
df3<-scale(df2)
autoplot(prcomp(df3), data = metabolites, colour = 'PCA',
loadings = TRUE, loadings.colour = 'purple',
loadings.label = TRUE, loadings.label.size = 3)
df <- metabolites[c(8:15)]
dff<- df[c(1:4,6:8)]
autoplot(prcomp(dff), data = metabolites, colour = 'PCA',
loadings = TRUE, size = 3, loadings.colour = 'black',
loadings.label = TRUE, loadings.label.size = 4, loadings.label.colour = 'black' )
# PCA SS
df <- metabolitosSS[c(8:15)]
dff<- df[c(1:4,6:8)]
autoplot(prcomp(dff), data = metabolitosSS, colour = 'PCA',
loadings = TRUE, size = 3, loadings.colour = 'black',
loadings.label = TRUE, loadings.label.size = 4, loadings.label.colour = 'black' )
dfSS<- as.matrix(df)
# PCA Conti
df <- metabolitosConti[c(8:15)]
dff<- df[c(1:4,6:8)]
autoplot(prcomp(dff), data = metabolitosConti, colour = 'PCA',
loadings = TRUE, size = 3, loadings.colour = 'black',
loadings.label = TRUE, loadings.label.size = 4, loadings.label.colour = 'black' )
metabolites<-read.delim("../../metadata/calculate_relative_abs.txt")
metabolites$PCA<-c(rep("SS15",5), rep("SS16",5),
rep("SD15",5),rep("SD16",5),
rep("CS15",5),rep("CS16",5),
rep("CD15",5),rep("CD16",5))
#Exportar Data frame
exp_table<-metabolites[,c(1,8:15)]
write.csv(exp_table, file="../../metadata/exp_table.csv")
write.table(exp_table, file="../../metadata/exp_table.txt")
metabolitosSS<-metabolites[1:20,]
metabolitosConti<-metabolites[21:40,]
df <- metabolites[c(8:15)]
autoplot(prcomp(df))
autoplot(prcomp(df), data = metabolites, colour = 'PCA', label = TRUE, label.size = 10)
autoplot(prcomp(df), data = metabolites, colour = 'PCA', shape = FALSE, label.size = 3)
autoplot(prcomp(df), data = metabolites, colour = 'PCA', loadings = TRUE)
autoplot(prcomp(df), data = metabolites, colour = 'PCA',
loadings = TRUE, loadings.colour = 'purple',
loadings.label = TRUE, loadings.label.size = 3)
df2
df
df <- metabolites[c(8:15)]
autoplot(prcomp(df))
autoplot(prcomp(df), data = metabolites, colour = 'PCA', label = TRUE, label.size = 10)
autoplot(prcomp(df), data = metabolites, colour = 'PCA', shape = FALSE, label.size = 3)
autoplot(prcomp(df), data = metabolites, colour = 'PCA', loadings = TRUE)
autoplot(prcomp(df), data = metabolites, colour = 'PCA',
loadings = TRUE, loadings.colour = 'purple',
loadings.label = TRUE, loadings.label.size = 3)
